\input sys/inputs.tex

\begin{document}

\bigheading{Posters on the wall}

% \info{task_name}{infile}{outfile}{points}{timelimit}{memlimit}
% leave this values, if you are not interested
\info{posters}{stdin}{stdout}{100}{5000 ms}{1 GB}

Deep in the top-secret base of Keepers of the Sacred Postulates, there's The
Wall with many rectangular posters depicting deep knowledge derived from their
most valuable postulates. They are quite rare, thus they are placed so that they don't overlap.

Occasionally, a batch of new posters worthy of the honor of
being placed on The Wall arrives. The Keepers then have to decide, where to place
the new posters. It's a complicated process and you are to help with one of its steps.

The Keepers are currently picking candidate positions for the posters. You are
to quickly compute the total area of currently hanging posters that would
be shadowed by placing a new poster at a given position.

\heading{Task}

You are given a description of $n$ disjoint rectangles in a plane. You are to answer
$q$ queries of the form: What is the total area of intersection of the $n$ rectangles
with a new given rectangle? Note that this doesn't add the queried rectangle to the plane.

The answer has to be produced online.

\heading{Input}

The first line contains five numbers, $r, c, n, q, m$, ($1 \leq r, c < m \leq 10^9 + 9$, $0 \leq n,q \leq 50\,000$),
the height and width of the wall, number of posters on the wall, number of
queries and a modulus for computing the queries (we will explain that below).

Each of the next $n$ lines contains four numbers, $x_1, y_1, x_2, y_2$ ($0 \leq x_1, x_2 \leq r$,
$0 \leq y_1, y_2 \leq c$), the coordinates of two opposite corners of the rectangle.

The last $q$ lines contain five numbers $x_1', y_1', x_2', y_2', v$, each between
$0$ and $m - 1$ (inclusive). You can compute the real coordinates $x_1, y_1, x_2, y_2$
using the formula below.

Let's denote by $l$ the answer to the last query (with $l=0$ for the first query). Then 
$$x_i = (x_i' + l \cdot v) \pmod m$$
$$y_i = (y_i' + l \cdot v) \pmod m$$

The decoded constraints $x_1, y_1, x_2, y_2$ satisfy following conditions:
$0 \leq x_1, x_2 \leq r$, $0 \leq y_1, y_2 \leq c$. 

\heading{Output}

For each query output one line containing a single number: Answer to the query.

\heading{Subtasks}

There are several subtasks. In offline subtasks, the value $v$ will be zero for each query. 

\bigskip

\begin{center}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
subtask & points & maximum $r$  & maximum $c$   & maximum $n$ and $q$ & online    \\ \hline
1       & 10     & $500$        & $500$         & $500$     & no        \\ \hline
2       & 10     & $5000$       & $5000$        & $5000$    & no        \\ \hline
3       & 40     & $300\,000$   & $300\,000$    & $50\,000$ & no        \\ \hline
4       & 10     & $10^9$       & $200\,000$    & $50\,000$ & no        \\ \hline
5       & 10     & $10^9$       & $10^9$        & $50\,000$ & no        \\ \hline
6       & 10     & $100\,002$   & $100\,002$    & $50\,000$ & yes       \\ \hline
7       & 10     & $10^9 + 8$   & $10^9 + 8$    & $50\,000$ & yes       \\ \hline
\end{tabular}
\end{center}

\heading{Samples}


\sampleIN
8 11 3 4 13
1 1 5 5
7 7 5 4
4 6 2 7
1 1 7 8 0
2 2 4 3 0
3 4 6 7 0
2 9 3 10 0
\sampleOUT
24
2
6
0
\sampleCOMMENT
You can view the whole plane below.
\sampleEND
\center{
\includegraphics[width=12cm]{img/posters.pdf}
}

\sampleIN
8 11 3 4 13
1 1 5 5
7 7 5 4
4 6 2 7
1 1 7 8 4
6 6 8 7 2
2 3 5 6 7
11 5 12 6 5
\sampleOUT
24
2
6
0
\sampleCOMMENT
This is the same input as above, using online queries.
\sampleEND
\end{document}
